id: summarize
description: Build prompts for concise, faithful summaries
signature_template: input_context, objective, constraints -> compiled_prompt, checks
prompt_style: faithful_compression_contract
compiler_principles: |
  You are an expert prompt engineer specializing in summarization tasks. Generate a single,
  production-quality system prompt that functions as a complete behavior contract for
  faithful, well-scoped summaries.

  ## Generation Principles

  1. **Faithful Compressor Role**: Open with a role as a precise, faithful summarizer for
     the relevant domain. Establish that fidelity to the source is the top priority.
  2. **Constraint Fidelity**: Include ONLY constraints from the user's intent. Never invent
     length limits, citation requirements, or format prescriptions not in the request.
  3. **Scope Boundaries**: Define what is included and what is excluded. Ambiguous scope
     leads to either over-summarization or critical omissions.
  4. **No Hallucinated Additions**: Require that every claim in the summary traces back
     to the source. Unsupported additions must be flagged or removed.
  5. **Fact vs. Inference Distinction**: When the source implies but does not state something,
     require the model to label it as inferred rather than present it as fact.
  6. **Compression Target**: If the user specified a length or format, apply it. If not,
     do NOT prescribe one — let the model find the natural compression level.
  7. **Preserve Critical Structure**: Key relationships, causal chains, and caveats from
     the source must survive compression.
  8. **Output Contract**: Define what constitutes a complete summary: required coverage,
     fidelity standards, and how to handle source material that is ambiguous or contradictory.

  ## Quality Standard

  Every instruction must serve faithfulness and scope control. Never pad with generic
  summarization advice or impose format constraints the user did not request.
refine_principles: |
  You are refining an existing summarization prompt. Apply surgical, targeted improvements.

  ## Refinement Protocol

  1. **Diagnose First**: Identify the 2-3 highest-impact weaknesses from judge feedback.
  2. **Preserve What Works**: Keep sections that scored well.
  3. **Priority Order**: Scope ambiguity → hallucination risk → compression target issues
     → clarity issues.
  4. **Strip Hallucinations**: Remove any length limit, format requirement, or citation
     rule NOT in the user's intent.
  5. **Strengthen Scope**: If source scope or exclusions are unclear, add explicit boundary
     definitions.
  6. **Add Fidelity Guardrail**: If the prompt doesn't explicitly require tracing claims
     to the source, add it.
  7. **Remove Structural Noise**: Strip envelope tags, bracket markup, duplicate sections.
prompt_directives:
  - Open with a role definition as a precise, faithful summarizer
  - Use semantic XML tags to organize sections (e.g., <source_scope>, <constraints>, <compression_rules>, <output_format>, <failure_policy>)
  - Preserve source meaning and uncertainty without injecting new claims
  - Define compression target and excluded content explicitly with measurable criteria
  - Keep structure concise but traceable to source scope
  - Require clear distinction between facts and inferred context
  - Specify exact format expectations (bullet vs prose, max length, required sections)
  - End with a testable output contract including fidelity checks
  - Be dense and comprehensive — fill the token budget with actionable, specific guidance
  - Do NOT wrap the entire prompt in <system> or <prompt> envelope tags
quality_checklist:
  - summary objective and scope boundaries are explicit
  - ALL constraints come from the user's intent — no hallucinated policies or rules
  - output format is NOT specified unless the user explicitly requested one
  - no unsupported claims are introduced
  - compression ratio or brevity target is stated only if the user specified one
  - output contract reflects the user's actual success criteria
  - role/identity is established in the opening lines
clarification_policy:
  - Ask for target audience and desired summary length when absent
  - Ask whether to include caveats, risks, or action items when unclear
ambiguity_resolution_rules:
  - If source scope is unclear, ask for boundaries before final summary
  - If format preference is unclear, default to concise structured bullets
forbidden_patterns:
  - etc
  - maybe
  - various
  - single-message only
  - exactly 3 rounds
  - arbitrary word limit
  - '[section]'
  - '[[block]]'
  - <system>
friction_markers:
  - in one message
  - single user message
  - maximum two rounds
  - at most two
  - up to three clarification rounds
  - allow up to three clarification attempts
  - interaction will end
  - after two clarification attempts
  - after three clarification attempts
  - "≤\u202f2,000 words"
  - 2,000 words per question
  - cited directly after the statement
  - in parentheses
  - "[instruction_hierarchy]"
  - "[input_boundary]"
  - "[failure_policy]"
  - "[output_contract]"
  - "[final_self_check]"
  - "[[instruction_hierarchy]]"
  - "[[input_boundary]]"
  - "[[failure_policy]]"
  - "[[output_contract]]"
  - "[[final_self_check]]"
  - "<prompt>"
  - "</system>"
required_sections:
  - goal
  - source_scope
  - compression_ratio
  - exclusions
  - output_contract
required_prompt_blocks:
  - instruction_hierarchy
  - input_boundary
  - failure_policy
  - output_contract
  - final_self_check
required_technique_markers:
  - objective
  - constraints
  - source scope
  - compression
  - output contract
vague_markers:
  - etc
  - maybe
  - something
  - various
  - and so on
ambiguity_penalty_per_marker: 0.04
ambiguity_penalty_cap: 0.35
missing_sections_weight: 0.25
missing_techniques_weight: 0.20
eval_weights:
  quality: 0.45
  clarity: 0.3
  constraint_fit: 0.15
  brevity: 0.10
judge_rubric:
  priorities:
    - prioritize faithfulness and scope control over verbosity
    - penalize hallucinated details and omission of critical points
  quality_checks:
    - summary preserves core claims and key evidence
    - compression ratio and exclusions are explicit
  clarity_checks:
    - output instructions are concise and scannable
    - avoids repetitive paraphrasing
  constraint_checks:
    - source boundaries are explicit
    - output contract is present and testable
  risk_checks:
    - flags unsupported additions
    - flags under-specified scope boundaries
